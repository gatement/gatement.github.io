<html>
<head>
<link rel="stylesheet" type="text/css" href="/css/site.css">
</head>
<body>
<h3>Setup kubernetes</h3>
<ol>
  <li>
    install CentOS 7
  </li>
  <li>
    config OS
    <pre>
    systemctl disable firewalld.service
    systemctl stop firewalld.service

    # vi /etc/selinux/config
    SELINUX=disabled
    </pre>
  </li>
  <li>
    install softwares
    <pre>
    yum install kubernetes etcd flannel docker
    </pre>
  </li>
  <li>
    config etcd
    <pre>
    # vim /etc/etcd/etcd.conf
    ETCD_DATA_DIR="/var/lib/etcd/default.etcd"
    ETCD_LISTEN_PEER_URLS="http://0.0.0.0:2380"
    ETCD_LISTEN_CLIENT_URLS="http://0.0.0.0:2379"
    ETCD_NAME="lpdmaster01"
    ETCD_INITIAL_ADVERTISE_PEER_URLS="http://lpdmaster01:2380"
    ETCD_ADVERTISE_CLIENT_URLS="http://lpdmaster01:2379"
    ETCD_INITIAL_CLUSTER="lpdmaster01=http://lpdmaster01:2380,lpdmaster02=http://lpdmaster02:2380,lpdmaster03=http://lpdmaster03:2380"
    ETCD_INITIAL_CLUSTER_TOKEN="123456"
    ETCD_INITIAL_CLUSTER_STATE="new"

    # check if working
    etcdctl cluster-health
    etcdctl member list
    </pre>
  </li>
  <li>
    config flannel
    <pre>
    etcdctl set /atomic.io/network/config '{ "Network": "192.168.0.0/16" }'

    # vim /etc/sysconfig/flanneld
    FLANNEL_ETCD_ENDPOINTS="http://lpdmaster01:2379,http://lpdmaster02:2379,http://lpdmaster03:2379"
    FLANNEL_ETCD_PREFIX="/atomic.io/network"
    FLANNEL_OPTIONS="-iface eth0"
    </pre>
  </li>
  <li>
    config iptables
    <pre>
    iptables -P FORWARD ACCEPT
    </pre>
  </li>
</ul>
</body>
</html>
